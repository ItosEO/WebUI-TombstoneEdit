# 白名单/黑名单管理功能使用指南

## 概述

ColorOS墓碑配置编辑器现在支持完整的白名单和黑名单管理功能，允许用户通过图形界面轻松管理各种类型的应用权限控制列表。

## 功能特性

### ✅ 支持的列表类型

#### 白名单管理
- **应用白名单 (whitePkg)** - 获得更宽松冻结策略的应用
- **快速冻结列表 (ffPkg)** - 控制快速冻结机制参与
- **闹钟管理列表 (alarm)** - 控制应用闹钟权限
- **广播组件列表 (cpnBroadcast)** - 控制广播接收权限
- **服务组件列表 (cpnService)** - 控制服务调用权限
- **代理广播列表 (proxyBroadcast)** - 控制广播代理机制
- **WakeLock代理列表 (proxyWL)** - 控制WakeLock代理
- **GPS代理列表 (proxyGps)** - 控制GPS定位代理

#### 黑名单管理
- **系统应用黑名单 (SysBlack)** - 对系统应用的限制配置
- **快速冻结黑名单 (ffPkg)** - 跳过快速冻结的应用
- **闹钟黑名单 (alarm)** - 禁止闹钟权限的应用
- **广播黑名单 (cpnBroadcast)** - 禁止广播接收
- **服务黑名单 (cpnService)** - 禁止服务调用
- **代理广播黑名单 (proxyBroadcast)** - 强制代理广播

## 使用方法

### 1. 访问管理界面

1. 打开ColorOS墓碑配置编辑器
2. 在左侧导航栏中点击"白名单管理"或"黑名单管理"
3. 选择要管理的列表类型

### 2. 查看现有项目

- 选择列表类型后，系统会自动加载并显示现有项目
- 项目以表格形式展示，包含所有相关属性
- 支持类型徽章和状态标识，便于快速识别

### 3. 添加新项目

1. 选择列表类型
2. 点击"添加项目"按钮
3. 在弹出的对话框中填写必要信息：
   - **包名 (pkg)**: 应用的包名，如 `com.tencent.mm`
   - **类型 (type)**: 选择白名单、黑名单或其他类型
   - **分类 (category)**: 选择适当的分类（如适用）
   - **其他属性**: 根据列表类型填写相应属性
4. 点击"保存"完成添加

### 4. 编辑现有项目

1. 在项目列表中找到要编辑的项目
2. 点击"编辑"按钮（铅笔图标）
3. 在弹出的对话框中修改信息
4. 点击"保存"确认修改

### 5. 删除项目

1. 在项目列表中找到要删除的项目
2. 点击"删除"按钮（垃圾桶图标）
3. 确认删除操作

### 6. 批量导入/导出

#### 导出功能
1. 选择列表类型
2. 点击"导出"按钮
3. 系统会下载JSON格式的配置文件

#### 导入功能
1. 选择列表类型
2. 点击"导入"按钮
3. 选择JSON文件或直接粘贴JSON数据
4. 点击"导入"开始处理
5. 查看导入结果统计

## 配置示例

### 应用白名单示例
```json
[
  {
    "name": "com.tencent.mm",
    "category": "001"
  },
  {
    "name": "com.coloros.alarmclock", 
    "category": "100"
  }
]
```

### 快速冻结配置示例
```json
[
  {
    "type": "white",
    "pkg": "com.coloros.ocrscanner"
  },
  {
    "type": "black",
    "pkg": "com.android.settings"
  }
]
```

### 闹钟管理示例
```json
[
  {
    "type": "white",
    "pkg": "com.coloros.gallery3d",
    "action": "*"
  }
]
```

## 分类说明

### 应用白名单分类
- **100**: 强制白名单 - 最高优先级，完全豁免限制
- **010**: OPPO/OnePlus白名单 - 系统应用白名单
- **001**: 第三方白名单 - 第三方应用白名单

### 快速冻结类型
- **white**: 白名单 - 允许快速冻结
- **black**: 黑名单 - 跳过快速冻结
- **skipAppSwitch**: 跳过应用切换检查

### 代理类型
- **white**: 白名单 - 不进行代理
- **black**: 黑名单 - 完全禁止
- **proxy**: 代理 - 延迟处理
- **gray**: 灰名单 - 条件代理

## 注意事项

### ⚠️ 重要提醒

1. **备份配置**: 修改前请务必备份原始配置
2. **测试验证**: 添加新规则后建议先测试效果
3. **系统应用**: 谨慎修改系统应用的黑白名单设置
4. **包名准确性**: 确保包名拼写正确，错误的包名不会生效

### 🔧 最佳实践

1. **分类管理**: 根据应用类型合理分类管理
2. **定期清理**: 定期清理不再需要的规则
3. **文档记录**: 为重要规则添加注释说明
4. **渐进调整**: 逐步调整规则，观察效果后再继续

### 🚫 常见错误

1. **包名错误**: 使用错误的包名导致规则无效
2. **类型冲突**: 同一应用在白名单和黑名单中冲突
3. **权限不足**: 某些系统级规则需要root权限
4. **格式错误**: 导入时JSON格式不正确

## 技术支持

如果在使用过程中遇到问题：

1. 检查日志文件：`/cache/webui_tombstone.log`
2. 验证配置文件：确保XML格式正确
3. 重启应用：重新加载配置
4. 恢复备份：如有问题可恢复之前的配置

## 更新日志

### v1.0.0 (2025-01-26)
- ✅ 完整的白名单/黑名单管理界面
- ✅ 支持8种主要列表类型
- ✅ 图形化添加、编辑、删除功能
- ✅ 批量导入/导出功能
- ✅ 实时配置验证
- ✅ 完整的日志记录
- ✅ 响应式设计支持

---

**ColorOS墓碑配置编辑器** - 让配置管理更简单、更安全、更高效！
